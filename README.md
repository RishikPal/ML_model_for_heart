# ML_model_for_heart
This repository offers, MATLAB code, and signal processing workflows for analyzing Phonocardiogram (PCG) and Electrocardiogram (ECG) signals. It covers techniques like signal acquisition, filtering, normalization, spectral analysis, and Pan-Tompkins QRS detection for cardiovascular diagnostics.
Excellent — let’s craft a detailed, structured, and polished `README.md` you can directly use in your GitHub repo. I’ll use clean Markdown conventions, good visual organization (badges, emojis, headings, code blocks), and precise descriptions of both the PCG and ECG workflows based on your workshop content. Here’s the full version:

---

# 📊 Biomedical Signal Proccessing

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

## 📖 Overview

Welcome to this repository of educational resources, code examples, and signal processing workflows focused on **Phonocardiogram (PCG)** and **Electrocardiogram (ECG)** signal analysis. This content is derived from workshops conducted by **Saibal Ghosh**, introducing fundamental biomedical signal processing techniques using MATLAB.

These resources cover everything from basic signal acquisition to advanced time-frequency analysis and fiducial point detection using adaptive filtering and classical algorithms like **Pan-Tompkins**.

---

## 📂 Repository Structure

```
📁 /PCG_Workshop
    📄 PCG_Signal_Processing_Workflow.m
    📄 PCG_Spectrogram_and_PSD_Analysis.m
    📄 README.md

📁 /ECG_Workshop
    📄 ECG_PanTompkins_Implementation.m
    📄 ECG_Fiducial_Point_Detection.m
    📄 README.md

📄 LICENSE
📄 README.md
```

---

## 🔬 Phonocardiogram (PCG) Signal Processing

### 📌 What is a PCG?

A **Phonocardiogram (PCG)** is the acoustic recording of heart sounds generated by the mechanical activities of the heart, often used to detect valve abnormalities, murmurs, and cardiac cycle events.

---

### 📊 Techniques Covered

* **Signal Acquisition & Sampling**

  * Importance of Nyquist theorem
  * Avoiding aliasing with appropriate sampling frequency

* **Transient Spike Removal**

  * Schmidt’s spike removal algorithm for denoising

* **Normalization**

  * Z-Score and Min-Max scaling to standardize amplitude range

* **Power Spectral Density (PSD) Estimation**

  * Using segmented FFT (Welch’s method)
  * Decibel-scaled PSD plots

* **Spectrogram Analysis**

  * Time-frequency visualization via Short-Time Fourier Transform (STFT)
  * Custom color scaling for clarity (`caxis([-60 40])`)

---

### 🩺 Application: Coronary Artery Disease (CAD) Detection

Analyzing PCG patterns for:

* 1-vessel, 2-vessel, and 3-vessel CAD
* Distinguishing between normal and pathological valve sound patterns

---

## 💓 Electrocardiogram (ECG) Signal Processing

### 📌 What is an ECG?

An **Electrocardiogram (ECG)** records the electrical activity of the heart via surface electrodes, commonly used to detect:

* Arrhythmias
* Myocardial infarctions
* Cardiomyopathies
* Conduction blocks

---

### 📊 Processing Pipeline (Enhanced Pan-Tompkins Algorithm)

1. **DC Removal**

   ```matlab
   x1 = x1 - mean(x1);
   ```

2. **Normalization**

   ```matlab
   x1 = x1 / max(abs(x1));
   ```

3. **Filtering**

   * **Low-Pass Filter (IIR)**
   * **High-Pass Filter (FIR)**
   * Custom MATLAB implementations for Pan-Tompkins compatible filtering

4. **Derivative Filtering**
   Highlighting rapid changes (like QRS complexes)

   ```matlab
   h = [-1 -2 0 2 1]/8;
   ```

5. **Squaring Operation**
   Emphasizing sharp slopes and suppressing minor fluctuations

6. **Moving Window Integration (MWI)**

   ```matlab
   h = ones(1,31)/31;
   ```

7. **Adaptive Thresholding**

   * Detect QRS complex regions dynamically

8. **Fiducial Point Detection**

   * **R-peak detection**
   * **Q, S, T, and P peak detection**
   * Using derivative, windowed search, and amplitude ranking

---

### 🩺 Clinical Application

Detection and analysis of:

* Right Bundle Branch Block (RBBB)
* Hypertension
* Atrial Fibrillation (AF)
* Dilated Cardiomyopathy (DCM)
* Complete Heart Block (CHB)

---

## 💾 Technologies & Tools

* MATLAB (Signal Processing Toolbox recommended)
* Time-Domain and Frequency-Domain Signal Analysis
* Adaptive Filtering and Classical QRS Detection Algorithms

---

## 📚 References

* Pan, J., & Tompkins, W. J. (1985). *A real-time QRS detection algorithm*. IEEE Transactions on Biomedical Engineering.
* R. R. Sahoo et al. (2024). *Prediction of ECG fiducial parameters from PPG signals*. Biomedical Signal Processing and Control, vol. 90.

